<html>
    <head>
        <title>ol3 - Ex7c - Styling function</title>
        <meta charset="UTF-8">
        <script type="text/javascript" src="js/config.js"></script>
        <link rel="stylesheet" href="lib/layerswitcher/ol3-layerswitcher.css" type="text/css">
        <script src="lib/layerswitcher/ol3-layerswitcher.js" type="text/javascript"></script>
        <script src="js/cartoDB.js" type="text/javascript"></script>
        <script type="text/javascript">
        
            var map;

            let OSM_layer = new ol.layer.Tile({

                            source: new ol.source.OSM(),
                            title: "OpenStreetMaps",
                            type: "base",
                            
                        });

            let Bing_layer = new ol.layer.Tile({
                            title: "Bing",
                            type: "base",
                            source: new ol.source.BingMaps({
                            key: 'AqE05oJsq-bWa50FPOW2S0eQm9Oqqygc1VTi_WPhUIoKR_-jgA559CRbfndgWAIz',
                            imagerySet: 'Aerial'
                            })
                        });

           //Vector layers

            let ARRETS_TPG = new ol.layer.Vector({
                title: "Arrêts TPG",
                source: new ol.source.Vector({
                    url: "https://audreyhuguenin.carto.com/api/v2/sql?format=GeoJSON&q=select%20cartodb_id,%20the_geom,%20nom_arret,%20ligne,%20direction%20from%20public.tpg_arrets",
                    format: new ol.format.GeoJSON()
                })
            });

            let velo_itinairaire = new ol.layer.Tile({
                source: cartoDBSource3,
                title: "Itinéraire de vélo"
            });

            let installations_sportive = new ol.layer.Tile({
                    source: cartoDBSource4,
                    title: "Installations sportives"
            });

            let ZONES_loisirs = new ol.layer.Tile({
                    source: cartoDBSource7,
                    title: "Itinéraires loisirs divers"
            });

            // layer tiles

            let WC = new ol.layer.Tile({
                source: cartoDBSource2,
                title: "WC Genève"
            });

            let Equipement_plages = new ol.layer.Tile({
                source: cartoDBSource5,
                title: "Equipements plages (WC/douches)"
            });

            let Pollution_Air = new ol.layer.Tile({
                source: cartoDBSource6,
                title: "Pollution de l'air (voir légende)"
            });

            console.log(installations_sportive);


$(document).ready(function () {

                map = new ol.Map({
                    view: new ol.View({
                        center:[710000, 5840171],
                        zoom: 10
                    }),
                    target: 'map',
                    layers: [
                        new ol.layer.Group({
                            title: 'Maps',
                            layers: [
                                OSM_layer,
                                Bing_layer,
                            ]
                        }),
                        new ol.layer.Group({
                            title: 'Data tiles',
                            layers: [
                                WC,
                                Equipement_plages,
                                Pollution_Air
                            ]
                        }),
                        new ol.layer.Group({
                            title: 'Data Vector',
                            layers: [
                                ARRETS_TPG,
                                velo_itinairaire,
                                installations_sportive,
                                ZONES_loisirs
                            ]
                        })
                    ]                
                });

                map.getView().setCenter(ol.proj.transform([6.1667, 46.2], "EPSG:4326", "EPSG:3857"));
                map.getView().setZoom(12);
                
                var layerSwitcher = new ol.control.LayerSwitcher();
                map.addControl(layerSwitcher); 
                      
});

        </script>
        <style type="text/css">
            #map {
                width: 100%;
                height: 100%;
            }
        </style>
    </head>
    <body>
        <div id="map"></div>
    </body>
</html>